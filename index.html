<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StoreConnect POS Actions - Lightning Out</title>
  <style>
    body { margin: 0; padding: 20px; font-family: 'Salesforce Sans', Arial, sans-serif; }
    #status { padding: 12px; margin-bottom: 20px; color: #444; background: #f3f3f3; border-radius: 4px; }
    #status.error { color: #b00020; background: #ffebee; }
    #status.success { color: #2e7d32; background: #e8f5e9; }
    #container { width: 100%; min-height: 500px; }
    #logs { background: #1e1e1e; color: #d4d4d4; padding: 12px; border-radius: 4px; font-family: monospace; font-size: 11px; max-height: 200px; overflow-y: auto; margin-top: 20px; }
    .log-info { color: #4fc3f7; }
    .log-success { color: #81c784; }
    .log-error { color: #ef5350; }
  </style>
  <!-- Classic Lightning Out script from EC Site -->




  
</head>
<body>
    <script type="text/javascript" async="" src="https://warranty2amartfurniture--amartuat.sandbox.my.salesforce.com/lightning/lightning.out.latest/index.iife.prod.js"></script>

  
  <h2>StoreConnect POS Actions - Lightning Out</h2>
  <div id="status">Initializing...</div>
  <div id="container"></div>
  <div id="logs"></div>



  <!-- Lightning Out 2.0 web component: base configuration -->
  <lightning-out-application
    app-id="1Us9n00000000mPCAQ"
    frontdoor-url="https://warranty2amartfurniture--amartuat.sandbox.my.salesforce.com/secur/frontdoor.jsp?otp=00D9n000002gTAv%21AQEAQGNPCvkDkIUhoS6XEABhZ0BB5eGVsG7975DYioTE_WhCJA693eRhqvuZtX5cdS1PWgGLDLpOrOelg2l3MDjjJw111xs1&cshc=3000000QMHjn000002gTAv"
    components="pos-actions-host-lwc"
  >
  </lightning-out-application>
  <!-- Lightning Out 2.0 web component with optional styling hooks -->
  <pos-actions-host-lwc></pos-actions-host-lwc>
 
  <!--<c-my-lwc style="--custom-color: brown;">
    
    <iframe>
      <html>
    
        <body>
    
          <c-my-lwc style="--custom-color: brown;"></c-my-lwc>
        </body>
      </html>
    </iframe>
    
  </c-my-lwc>-->

    

<!--  <script>
    const APP_NAME = 'c:posActionsOutApp';  // Your Lightning Out App that extends ltng:outApp
    const COMPONENT = 'c:posActionsHostLWC';
    const RAILWAY_PROXY = 'https://sc-auth-amart-production.up.railway.app';
    const ENV = 'uat';
    const EC_SITE = 'https://warranty2amartfurniture--amartuat.sandbox.my.site.com/posactions';

    const statusEl = document.getElementById('status');
    const container = document.getElementById('container');
    const logsEl = document.getElementById('logs');

    function log(msg, type) {
      type = type || 'info';
      var timestamp = new Date().toISOString().split('T')[1].slice(0, 12);
      var line = document.createElement('div');
      line.className = 'log-' + type;
      line.textContent = '[' + timestamp + '] ' + msg;
      logsEl.appendChild(line);
      logsEl.scrollTop = logsEl.scrollHeight;
      console.log('[LO:' + type + '] ' + msg);
    }

    function setStatus(msg, type) {
      log(msg, type || 'info');
      statusEl.textContent = msg;
      statusEl.className = type || '';
    }

    async function init() {
      try {
        log('=== Starting Lightning Out initialization ===');
        log('$Lightning available: ' + (typeof $Lightning !== 'undefined'), typeof $Lightning !== 'undefined' ? 'success' : 'error');

        if (typeof $Lightning === 'undefined') {
          throw new Error('$Lightning not available - script may not have loaded');
        }

        setStatus('Fetching frontdoor URL...');
        var resp = await fetch(RAILWAY_PROXY + '/api/lo2/frontdoor', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ env: ENV, appId: null })
        });

        var data = await resp.json();
        log('Response: ' + JSON.stringify(data), resp.ok ? 'success' : 'error');

        if (!resp.ok || !data.frontdoorUrl) {
          throw new Error(data.error || 'No frontdoor URL returned');
        }

        log('Frontdoor URL: ' + data.frontdoorUrl);

        setStatus('Calling $Lightning.use()...');
        log('App: ' + APP_NAME);
        log('EC Site: ' + EC_SITE);

        $Lightning.use(APP_NAME, function() {
          log('$Lightning.use() callback fired!', 'success');
          setStatus('Creating component...');

          $Lightning.createComponent(
            COMPONENT,
            {},  // attributes
            container,
            function(cmp) {
              if (cmp) {
                log('Component created successfully!', 'success');
                setStatus('Component loaded!', 'success');
              } else {
                log('Component creation returned null/undefined', 'error');
                setStatus('Component creation failed', 'error');
              }
            }
          );
        }, EC_SITE, data.frontdoorUrl);  // Pass EC site URL and frontdoor URL

      } catch (err) {
        log('ERROR: ' + err.message, 'error');
        if (err.stack) log('Stack: ' + err.stack, 'error');
        setStatus('Error: ' + err.message, 'error');
      }
    }

    log('Page loaded');
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>-->
</body>
</html>
